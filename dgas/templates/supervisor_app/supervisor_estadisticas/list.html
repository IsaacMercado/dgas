{% extends "base.html" %}
{% load static i18n %}
{% load humanize %}
{% block title %}Supervisor - Estadísticas{% endblock %}


{% block css %}

    <link rel="stylesheet" type="text/css" href="{% static 'bower_components/bootstrap-daterangepicker/daterangepicker.css' %}" />

{% endblock css %}

{% block content-header %}

    <section class="content-header">
        <h1>
            Estadísticas
            <small>Información</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i>listado General</a></li>
        </ol>
    </section>

{% endblock content-header %}

{% block content %}

    <div class="alert alert-success" id="success-alert" style="display: none">
        <button type="button" class="close" data-dismiss="alert">x</button>
        <strong>Mensaje: </strong>
        Regitro procesado.
    </div>

    <!-- Small boxes (Stat box) -->
    <div class="row">
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-aqua">
                <div class="inner">
                    <h3>{{ num_user }}</h3>

                    <p>Usuario registrados</p>
                </div>
                <div class="icon">
                    <i class="ion ion-bag"></i>
                </div>
                <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>
        <!-- ./col -->
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-green">
                <div class="inner">
                    <h3>{{ num_vehiculos }}</h3>

                    <p>Vehículos registrados</p>
                </div>
                <div class="icon">
                    <i class="ion ion-stats-bars"></i>
                </div>
                <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>
        <!-- ./col -->
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-yellow">
                <div class="inner">
                    <h3>{{ num_atendidos }}</h3>

                    <p>Usuarios atendidos en el día</p>
                </div>
                <div class="icon">
                    <i class="ion ion-person-add"></i>
                </div>
                <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>
        <!-- ./col -->
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-red">
                <div class="inner">
                    <h3>{{ num_rebotados }}</h3>

                    <p>Número de rebotados al día</p>
                </div>
                <div class="icon">
                    <i class="ion ion-pie-graph"></i>
                </div>
                <a href="#" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div>
        <!-- ./col -->
    </div>
    <!-- /.row -->



<div class="box box-primary">
    <div class="box-header with-border">
        <h3 class="box-title">Consulta</h3>
    </div>
    <!-- /.box-header -->
    <!-- form start -->
    <form role="form" id="formToPlot" action="javascript:toPagePlots()" data-url="{% url 'supervisor_app:supervisor_plots' %}">
        <div class="box-body">

        <div class="row">
            <div class="col-xs-3">
            
                <div class="form-group">
                    <label for="rangeDateConsult">Rango de Fechas</label>
                    <div class="input-group date">
                      <div class="input-group-addon">
                        <i class="fa fa-calendar"></i>
                      </div>
                      <input type="text" class="form-control pull-right"  name="daterange" value="01/01/2018 - 01/15/2018" id="rangeDateConsult">
                    </div>
                </div>

            </div>
            <div class="col-xs-3">
            
                <div class="form-group">
                    <label for="selectMunicipio">Municipio</label>
                    <select class="form-control" id="selectMunicipio" name="municipioPlot">
                        <option value="">Todos</option>
                        {% for mun in municipios %}
                        <option value="{{ mun.id }}">{{ mun.id }} - {{ mun }}</option>
                        {% endfor %}
                    </select>
                </div>

            </div>
            <div class="col-xs-3">
            
                <div class="form-group">
                    <label for="selectParroquia">Parroquía</label>
                    <select class="form-control" id="selectParroquia" name="parroquiaPlot" disabled>
                        <option value="">Todos</option>
                    </select>
                </div>

            </div>
            <div class="col-xs-3">
            
                <div class="form-group">
                    <label for="selectEstacion">Estación</label>
                    <select class="form-control" id="selectEstacion" name="estacionPlot">
                        <option value="">Todos</option>
                    </select>
                </div>

            </div>

        </div>
        
        </div>

        <!-- /.box-body -->

        <div class="box-footer">
            <button type="submit" class="btn btn-primary">Consultar</button>
        </div>
    </form>
</div>
     
          <div class="box box-primary">
            <div class="box-header">
              <h3 class="box-title">Resultados</h3>
            </div>
            <div class="box-body">
            
                <div class="embed-responsive embed-responsive-16by9">
                  <iframe id="iframePlots" class="embed-responsive-item"></iframe>
                </div>
               
            </div>
            <!-- /.box-body -->
          </div>


{% endblock content %}

{% block js %}

    <script src="{% static 'bower_components/moment/min/moment.min.js' %}"></script>
    <script src="{% static 'bower_components/bootstrap-daterangepicker/daterangepicker.js' %}"></script>
    
    <script>
        $(function() {
          $('input[name="daterange"]').daterangepicker({
            opens: 'left',
            maxDate: moment(),
            startDate: moment().subtract(1, 'month'),
            endDate: moment(),
          });
        });
    </script>
    
    <script>
        function toPagePlots(){
            var params = $.param($('#formToPlot').serializeArray());
            var newUrl = $('#formToPlot').attr('data-url') + '?' + params;
            $("#iframePlots").attr('src', newUrl);
        }
    </script>


{% endblock js %}

